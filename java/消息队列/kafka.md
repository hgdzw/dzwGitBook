* kafka的消息模型是什么
* kafka的消息是怎么消费的





### 一、kafka的消息模型
   ![image](../image/kafka消息模型.png)  
   * 生产者: 负责发送消息的
   * topic: 主题,生产者和消费者都是对这个主题进行的操作
   * 分区(partition): 存在于topic中的,一个topic可以有多个partition 
   * 消费者组: 每个消费者组都是相对独立的 都能获取到全量的订阅的消息
   * 消费者: 在消费者组中的,订阅主题的分区对应的就是消费者 如果消费者数据大于分区 会多余
   
### 二、 消费者是怎么消费的
   ![image](../image/kafka消费.png)  
   每个不同的业务分为一个消费者组,订阅一个topic的全量消息,如果消息堆积过多,我们一般在消费者组中增加消费者 这样多消费者就可以将消息尽快的消费  
   消费者在消费消息的时候 在本地保存一个offset 可以手动或者自动更新到服务器,标明消费的消息到哪里了 是一个偏移
   
   
### 三、重平衡
   重平衡其实是一个协议,它规定了如何让消费者组中的消费者来消费topic中的每一个分区,可以让消费者数据和分区尽量平均 这就是重平衡,但是重平衡期间,**消费者无法从kafka中消费消息**
   #### 重平衡的触发条件
   * 消费者组内成员发生变更
   * 主题的分区数发送变更
   * 订阅的主题发生变化:当消费者组使用正则表达式订阅主题，而恰好又新建了对应的主题，就会触发重平衡
   #### 重平衡策略
   todo
   
### 四、消息持久化
   